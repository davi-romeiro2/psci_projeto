<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Cadastro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/login/cadastro.css">
</head>

<body>
    <!-- Modal de Cadastro -->
    <div id="register-modal">
        <h2>Cadastro</h2>
        <form class="register-form">
            <div class="age-question-container">
                <p class="age-question-text">Quantos anos você tem?</p>
                <div class="checkboxes">
                    <label><input type="checkbox" name="type" value="crianca"> Criança (5–10 anos)</label>
                    <label><input type="checkbox" name="type" value="adolescente"> Adolescente (12–17 anos)</label>
                    <label><input type="checkbox" name="type" value="adulto"> Adulto (+18)</label>
                </div>
            </div>

            <!-- Criança ou Adolescente -->
            <div id="form-kid-teen" class="hidden">
                <label>Email</label>
                <input type="email" placeholder="Digite seu email" required />

                <label>Email do responsável</label>
                <input type="email" placeholder="Digite o email do responsável" required />

                <label>Senha</label>
                <ul class="password-requirements">
                    <li id="kid-req-uppercase">• Uma letra maiúscula</li>
                    <li id="kid-req-special">• Um caractere especial (@#$%&*)</li>
                    <li id="kid-req-number">• Um número</li>
                    <li id="kid-req-length">• No mínimo 8 caracteres</li>
                </ul>
                <input type="password" id="password-cadastro-kid" required />

                <label>Idade</label>
                <input type="number" placeholder="Digite sua idade" required />

                <label>Gênero</label>
                <select required>
                    <option value="">Selecione</option>
                    <option>Masculino</option>
                    <option>Feminino</option>
                    <option>Outro</option>
                </select>

                <label>Telefone dos responsáveis</label>
                <input type="tel" placeholder="Digite o telefone dos responsáveis" required />

                <label>Seu telefone</label>
                <input type="tel" placeholder="Digite seu telefone (WhatsApp)" required />
            </div>

            <!-- Adulto -->
            <div id="form-adult" class="hidden">
                <label>Email</label>
                <input type="email" placeholder="Digite seu email" required />

                <label>Senha</label>
                <ul class="password-requirements">
                    <li id="adult-req-uppercase">• Uma letra maiúscula</li>
                    <li id="adult-req-special">• Um caractere especial (@#$%&*)</li>
                    <li id="adult-req-number">• Um número</li>
                    <li id="adult-req-length">• No mínimo 8 caracteres</li>
                </ul>
                <input type="password" id="password-cadastro-adult" required />

                <label>Idade</label>
                <input type="number" placeholder="Digite sua idade" required />

                <label>Gênero</label>
                <select required>
                    <option value="">Selecione</option>
                    <option>Masculino</option>
                    <option>Feminino</option>
                    <option>Outro</option>
                </select>

                <label>Telefone</label>
                <input type="tel" placeholder="Digite seu telefone (WhatsApp)" required />
            </div>

            <button type="submit" id="register-btn">Cadastrar</button>
            <div id="forgot-password-login">
                <a href="./login.html" id="forgot-back-login" class="forgot-password">Voltar ao login</a>
            </div>
        </form>
    </div>

    <!-- Modal de Sucesso -->
    <div id="success-register-modal" class="modal hidden">
        <div class="modal-content">
            <svg style="width:50px; height:50px; fill: #3A503D; margin-bottom: 1rem;" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24">
                <path d="M9 16.17l-3.5-3.5L4 14.17l5 5 12-12-1.41-1.42z" />
            </svg>
            <h2 style="color:#3A503D;">Cadastro realizado com sucesso!</h2>
            <button id="success-register-ok"
                style="margin-top: 1rem; padding: 0.5rem 1.5rem; border:none; border-radius: 6px; background:#BB8991; color:#fff; font-weight:bold; cursor:pointer;">OK</button>
        </div>
    </div>

    <script>
        const checkboxes = document.querySelectorAll('input[name="type"]');
        const formKidTeen = document.getElementById('form-kid-teen');
        const formAdult = document.getElementById('form-adult');
        const registerBtn = document.getElementById('register-btn');
        const successModal = document.getElementById('success-register-modal');

        // SENHA: lógica para mostrar verde/vermelho
        function validatePassword() {
            const activeForm = !formKidTeen.classList.contains('hidden') ? formKidTeen : formAdult;
            const passwordInput = activeForm.querySelector('input[type="password"]');
            if (!passwordInput) return true;

            const password = passwordInput.value;
            const prefix = passwordInput.id.includes('kid') ? 'kid' : 'adult';

            const reqUppercase = document.getElementById(`${prefix}-req-uppercase`);
            const reqSpecial = document.getElementById(`${prefix}-req-special`);
            const reqNumber = document.getElementById(`${prefix}-req-number`);
            const reqLength = document.getElementById(`${prefix}-req-length`);

            const hasUppercase = /[A-Z]/.test(password);
            const hasSpecialChar = /[@#$%&*!]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const hasLength = password.length >= 8;

            reqUppercase.style.color = hasUppercase ? 'green' : 'red';
            reqSpecial.style.color = hasSpecialChar ? 'green' : 'red';
            reqNumber.style.color = hasNumber ? 'green' : 'red';
            reqLength.style.color = hasLength ? 'green' : 'red';

            return hasUppercase && hasSpecialChar && hasNumber && hasLength;
        }

        // Adiciona listener em todos os campos de senha
        document.querySelectorAll('input[type="password"]').forEach(input => {
            input.addEventListener('input', validatePassword);
        });

        // Troca de formulário ao selecionar tipo
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                if (checkbox.checked) {
                    // Desmarca os outros
                    checkboxes.forEach(cb => {
                        if (cb !== checkbox) cb.checked = false;
                    });

                    // Mostra formulário certo
                    if (checkbox.value === "adulto") {
                        formAdult.classList.remove("hidden");
                        formKidTeen.classList.add("hidden");
                    } else {
                        formKidTeen.classList.remove("hidden");
                        formAdult.classList.add("hidden");
                    }
                } else {
                    // Nenhuma checkbox marcada, esconder ambos os formulários
                    formKidTeen.classList.add("hidden");
                    formAdult.classList.add("hidden");
                }

                validatePassword(); // Atualiza requisitos da senha
            });
        });

        // Clique no botão de cadastro
        registerBtn.addEventListener('click', () => {
            const formToValidate = !formKidTeen.classList.contains("hidden")
                ? formKidTeen
                : formAdult;

            const requiredInputs = formToValidate.querySelectorAll("input[required], select[required]");

            let allFilled = true;
            requiredInputs.forEach(input => {
                if (!input.value.trim()) {
                    allFilled = false;
                }
            });

            const passwordIsValid = validatePassword();

            if (!allFilled) {
                showModal("Por favor, preencha todos os campos.");
                return;
            }

            if (!passwordIsValid) {
                showModal("A senha não atende aos requisitos.");
                return;
            }

            // Tudo certo
            successModal.classList.remove("hidden");
            successModal.style.display = "flex";
        });

        // Modal de erro (caso queira deixar igual estava)
        function showModal(message) {
            alert(message); // substitua por seu modal customizado se tiver
        }

        // Botão OK do modal de sucesso
        document.getElementById('success-register-ok').addEventListener('click', () => {
            successModal.classList.add("hidden");
            // resetar o formulário
            document.querySelector('form.register-form').reset();
            formKidTeen.classList.add("hidden");
            formAdult.classList.add("hidden");

            // Resetar cores dos requisitos
            ['kid', 'adult'].forEach(prefix => {
                document.getElementById(`${prefix}-req-uppercase`).style.color = 'red';
                document.getElementById(`${prefix}-req-special`).style.color = 'red';
                document.getElementById(`${prefix}-req-number`).style.color = 'red';
                document.getElementById(`${prefix}-req-length`).style.color = 'red';
            });
            window.location.href = 'login.html';
        });
    </script>

</body>

</html>